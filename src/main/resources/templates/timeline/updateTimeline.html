<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/css/5/cosmo/bootstrap.css">
<style type="text/css">
</style>
</head>
<body>
	<div th:name="getKakaoMap" th:include="timeline/component/map::kakaoMap"></div>

	<form th:action="@{/timeline/updateTimeline}" th:object="${record}" method="post" enctype="multipart/form-data">
	<input type="text" th:field="*{recordNo}" />
	<input type="text" th:field="*{recordUserId}" />
	<input type="text" th:field="*{latitude}" />
	<input type="text" th:field="*{longitude}" />
	<input type="text"th:field="*{tempType}" />
	<input type="text" th:field="*{recordAddDate}" />
	<input type="text" th:field="*{d_DayDate}" />
	<input type="text" th:field="*{timecapsuleType}" />
	<input type="text" th:field="*{updateCount}" />
	<input type="text" th:field="*{mediaName}" />
	<fieldset>
    <div class="row">
    	<div class="form-check form-switch d-flex justify-content-end">
    		<div>
				<span class="badge bg-primary" th:text="*{updateCount}+'번째 수정' "></span>
				&nbsp &nbsp
			</div> 
			<div class="form-check form-switch">
        		<input class="form-check-input" type="checkbox" id="sharedDateType" th:name="sharedDateType" th:checked="*{sharedDate!=null ? 'true' : 'false'}">
        		<label class="badge bg-primary" for="sharedDateType" th:text="*{sharedDate!=null ? '공유됨' : '비공유'}"></label>
      		</div>
		</div>
    </div>
		
    <div class="row">
    	<label for="recordTitle" class="form-label mt-4" th:text="'제목'"></label>
    	<input type="text" class="form-control" th:field="*{recordTitle}" placeholder="제목을 입력하세요. 입력 안하면 기본 값이 설정됩니다.">
		<small id="recordTitleHelp" class="form-text text-muted" th:text="'기본 값 : 주소_YYYY-MM-DD hh:mm:ss'"></small>
    </div>
		
    <div class="row">
		<label for="categoryNo" class="form-label mt-4" th:text="'카테고리'"></label>
    	<select class="form-select" th:field="*{categoryNo}">
			<option th:value="0" th:text="'없음'"/>
			<option th:each="c : ${category}" th:value="${c.categoryNo}" th:text="${c.categoryName}" th:selected="${record.categoryNo == c.categoryNo}"/>
		</select>
		<small id="categoryHelp" class="form-text text-muted" th:text="'카테고리 미설정 시, \'전체\' 로 분류됩니다.'"></small>
    </div>
    
    <div class="row">
      <label for="checkpointDate" class="form-label mt-4" th:text="'체크포인트 일시'"></label>
      <input type="text" class="form-control" th:field="*{checkpointDate}" readonly="readonly" autocomplete="off">
    </div>
    
    <div class="row">
      <label for="checkpointAddress" class="form-label mt-4" th:text="'체크포인트 주소'"></label>
      <input type="text" class="form-control" th:field="*{checkpointAddress}" readonly="readonly" autocomplete="off">
    </div>
    <br/>
    
    <div th:name="mediaName">
		<video width="320" height="240" controls>
        	<source th:src="${record.mediaName}" type="video/mp4">
    	</video>
    	<button class="btn btn-primary btn-sm" type="button" th:name="mediaX" th:text="x"></button>
		<!-- <span th:text="${record.mediaName}"></span> -->
    </div>
    <div class="row">
      <label for="mediaFile" class="form-label mt-4" th:text="'영상 파일'"></label>
      <input type="file" class="form-control" id="mediaFile" th:name="mediaFile" autocomplete="off">
	<small id="mediaFileHelp" class="form-text text-muted" th:text="'200MB까지 업로드 가능합니다.'"></small>
    </div>
    
	<div th:each="image : *{imageName}">
		<img th:src="${image.imageTagText}" />
		<!-- <span th:text="${image.imageTagText}"></span> -->
		<input type="hidden" name="imageNameText" th:value="${image.imageTagText}" />
		<button class="btn btn-primary btn-sm" type="button" th:name="imageX" data-imagetagorder="${image.imageTagOrder}" th:text="x"></button>
    </div>
    <div class="row">
		<label for="imageFile" class="form-label mt-4" th:text="'사진 파일'"></label>
		<input type="file" multiple class="form-control" id="imageFile" th:name="imageFile" autocomplete="off">
		<small id="imageFileHelp" class="form-text text-muted" th:text="'최대 9장까지 업로드 됩니다.'"></small>
    </div>
    
    <div class="row">
		<label for="hashtagText" class="form-label mt-4" th:text="'해시태그'"></label>
		<input type="text" class="form-control" th:id="hashtagText" th:name="hashtagText" th:value="${hashtagText}" 
		placeholder="#해시태그 형식으로 작성해주세요, 해시태그 당 20자까지 입력되며, 최대 20개의 해시태그 입력이 가능합니다." autocomplete="off">
		<small id="hashtagTextHelp" class="form-text text-muted" 
		th:text="'#해시태그 형식으로 작성해주세요, 해시태그 당 20자까지 입력되며, 최대 20개의 해시태그 입력이 가능합니다.'"></small>
    </div>
    
    <div class="row">
     	<label for="recordText" class="form-label mt-4" th:text="'텍스트'"></label>
     	<input type="text" class="form-control" th:field="*{recordText}" autocomplete="off">
		<small id="recordTextHelp" class="form-text text-muted" th:text="'1천 자 이하 작성 가능합니다.'"></small>
    </div>
    
	</fieldset>
	<button type="button" class="btn btn-primary btn-lg" th:name="updateTimeline" th:text="'다시작성'"></button>
	<button type="button" class="btn btn-primary btn-lg" th:name="addVoiceToText" th:text="'녹음하기'"></button>
	<button type="submit" class="btn btn-primary btn-lg" th:text="'작성완료'"></button>
	
	<!-- <ul>
	<li><a th:href="@{/timeline/updateTimeline(recordNo=1)}" th:text="'다시작성'"></a></li>
	<li><a th:href="@{/timeline/addVoiceToText}" th:text="'녹음하기'"></a></li>
	<li><button type="submit" th:text="'작성완료'"></button></li>
	</ul> -->
	</form>
		
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<!-- <script src="https://code.jquery.com/ui/1.13.3/jquery-ui.js" integrity="sha256-J8ay84czFazJ9wcTuSDLpPmwpMXOm573OUtZHPQqpEU=" crossorigin="anonymous"></script> -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
<script type="text/javascript">
$(function() {
	
	let recordNo=$('input[name="recordNo"]').val();
	let recordUserId=$('input[name="recordUserId"]').val();
	
	/* $("div[name='getKakaoMap']").click(function() {
		uri="?recordNo="+recordNo;
		self.location.replace("/timeline/getDetailTimeline"+uri);
	}) */
	
	$("button[name='updateTimeline']").click(function() {
		uri="?recordNo="+recordNo;
		self.location="/timeline/updateTimeline"+uri;
	})
	
	$("button[name='addVoiceToText']").click(function() {
		window.open("/timeline/addVoiceToText",'_blank','width=400,height=300,left=400,top=300,scrollbars=no,location=no,toolbar=no,menubar=no,resizable=no');
	})
	
	$("button[name='imageX']").click(function() {
		let imageTagOrder=$(this).data('imagetagorder');
		uri="?recordNo="+recordNo;
		self.location="/timeline/updateTimeline"+uri;
	})
})
</script>
</body>
</html>